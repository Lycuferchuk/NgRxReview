<div class="cart-page">
  <div class="cart-page__title-wrapper flex gap-16">
    <button
      mat-icon-button
      class="cart-page__back-btn"
      (click)="goBack()">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1 class="cart-page__title mb-16">Ваш кошик</h1>
  </div>

  @if (items().length) {
    <div class="cart-page__cart-wrapper">
      <div class="cart-page__content">
        <div class="cart-page__cart-list">
          @for (item of items(); track item.product.id) {
            <mat-card class="nexus-card cart-page__product">
              <div class="card-glow"></div>

              <div class="cart-page__image-wrap">
                <img
                  class="cart-page__image"
                  [src]="item.product.imageUrl"
                  [alt]="item.product.name"
                />
                <div class="cart-page__product-name">
                  <h2>{{ item.product.name }}</h2>
                  <p>{{ item.product.category }}</p>
                  <p>{{ item.product.brand }}</p>
                </div>
              </div>

              <div class="cart-page__action-block">
                <div class="cart-page__quantity-input">
                  <button
                    class="nexus-icon-button"
                    mat-icon-button
                    color="primary"
                    (click)="decreaseQuantity(item.product.id)"
                    [disabled]="item.quantity <= 1">
                    <mat-icon>remove</mat-icon>
                  </button>

                  <mat-form-field appearance="fill" class="nexus-counter-input">
                    <input
                      matInput
                      type="number"
                      [value]="item.quantity"
                      (change)="updateQuantity(item.product.id, $event)"
                      min="1"
                    />
                  </mat-form-field>

                  <button
                    class="nexus-icon-button"
                    mat-icon-button
                    color="primary"
                    (click)="increaseQuantity(item.product.id)">
                    <mat-icon>add</mat-icon>
                  </button>
                </div>

                <div class="cart-page__price-block">
                  <span class="cart-page__price">
                    {{ item.totalPrice | currency: 'UAH' : 'symbol-narrow' }}
                  </span>
                  <button
                    mat-flat-button
                    class="nexus-button"
                    color="warn"
                    (click)="removeFromCart(item.product.id)">
                    Видалити
                  </button>
                </div>
              </div>
            </mat-card>
          }
        </div>

        <div class="cart-page__summary">
          <mat-card class="nexus-card cart-page__summary-card">
            <h2>Разом</h2>
            <p class="cart-page__summary-price">
              {{ totalPrice() | currency: 'UAH' : 'symbol-narrow' }}
            </p>
            <button
              mat-flat-button
              color="primary"
              class="nexus-button cart-page__summary-checkout"
              (click)="checkout()">
              Оформити замовлення
            </button>
          </mat-card>
        </div>
      </div>
    </div>
  } @else {
    <app-nxs-no-data [type]="emptyStateType.EMPTY_CART"></app-nxs-no-data>
  }
</div>
